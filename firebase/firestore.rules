rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ğŸ”¥ ã‚†ãšã¯ã® UID ã‚’ã“ã“ã«ç›´æ¥æ›¸ã
    function isAdmin() {
      return request.auth != null &&
             request.auth.uid == "B6gAnMXikWhxofzChmOdBQoh9aY2" ||
             request.auth.token.isAdmin == true;
    }

    // --- ã‚µã‚¤ãƒˆè¨­å®š ---
    match /sites/{id} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // --- ã‚µã‚¤ãƒˆåˆ¥ä¼æ¥­ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« ---
    match /sites/{siteId}/companyProfiles/{companyId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // --- ä¼æ¥­ãƒã‚¹ã‚¿ ---
    match /companies/{id} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // --- ãƒ–ãƒ­ã‚° ---
    // å…¬é–‹ã•ã‚ŒãŸãƒ–ãƒ­ã‚°ã¯ä¸€èˆ¬èª­è€…ãŒèª­ã‚ã‚‹
    // ã‚†ãšã¯ã¯å…¨æ›¸ãè¾¼ã¿OK
    match /blogs/{id} {
      allow read: if resource.data.status == 'published' || isAdmin();
      allow write: if isAdmin();
    }

    // --- A8ã‚ªãƒ•ã‚¡ãƒ¼ ---
    match /offers/{offerId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // --- ãã®ä»–ã™ã¹ã¦ ---
    match /{document=**} {
      allow read: if isAdmin();
      allow write: if isAdmin();
    }
  }
}
