Root: apps/web
Install: pnpm -C ../.. -r install
Build: pnpm build
Include files outside root: ON

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
最重要.json ファイルを作成したらこれを実行
↓
pnpm run build:sites

firebase/functions/src/scripts/bootstrapSite.ts が.json ファイルの内容を作成します。
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
apps/web/lib/site-catalog.tsにサイトの情報を追加する感じかな？

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
## Jobs（定期/イベント）

- content/scheduledBlogDaily.ts … 朝6時=値下げ記事、昼12時=レビュー記事を自動生成して公開
- content/scheduledRewriteLowScoreBlogs.ts … 品質スコアが低い公開記事を自動リライト
- content/scheduledWeeklyPillar.ts … 毎週日曜9時、比較/選び方の柱記事を生成

- products/discoverProducts.ts … Amazon検索→ASIN発見→キュー投入（定期/手動）
- products/processAsinQueue.ts … ASINキューを処理して商品データを作成/更新
- products/updatePrices.ts … 価格情報を定期更新（定期/手動）
- products/pickAndGenerate.ts … 指定数のプロダクトからブログ下書きを作成（暫定運用用）

- seo/pullGscQueries.ts … GSC から検索クエリ取得し Firestore に保存（毎日 02:30 / 手動実行可）
- seo/generateFromGSC.ts … GSC クエリに基づき記事を自動生成（互換エイリアス: scheduledBlogFromGSC）

- hooks/publishBlog.ts … 記事が “published” になったときのフック（ISR再検証、sitemap ping, IndexNow 等）
- ops/queueHousekeeping.ts … キューのハウスキーピング（stuck解除、試行回数超過 fail、非FOCUS寝かせ、GC操作）
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

a8の商品を追加するときはこのファイルを実行する。

firebase/functions/src/scripts/tools/syncA8FromFiles.ts


ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

firebase/functions/src/jobs/a8/ingestFromFiles.tsはdataの内容をfiresotreに書く。


firebase/functions/src/jobs/a8/seedUiFromIngest.tsはingestされた内容をUI用に整形して書く。

ーーーーーーーーーーーーーーーーーーーーーーーーー
重要！企業の情報を追加して
pnpm -C firebase/functions run a8:sync
↑
（JSON → Firestore）


pnpm -C firebase/functions run normalizeA8
↑
（UI用に整形）

ーーーーーーーーーーーーーーーーーーーーーーーーーーー

関数の整理

scheduledBlogDaily_Morningは悩み、季節の毎日記事を生成する関数


このファイルはトレンド、キーワードをまとめて、blogに落とし込むファイル

firebase/functions/src/lib/content/painTopics_kariraku.json


ーーーーーーーーーーーーーーーーーーーーーーーーーーー
trackPainClickは、キーワードについている、idがあるんだけど、これをデータを集めるための関数

データの種類は、記事をクリックした時と比較ボタンを教えたときに反応するようにしています。

ーーーーーーーーーーーーーーーーーーーーーーーーー

📰 ブログ生成・改善まわり
scheduledKarirakuGuideDaily（悩み特化）とscheduledBlogDaily_Morning（季節特化）は悩み解決ブログをそれぞれ二つの関数を使用している
scheduledBlogA8_Morningは企業紹介ブログ
scheduledMonthlyCompareが比較ブログ
scheduledAnalyzeBlogsNightは記事の分析を行う関数
scheduledRewriteLowScoreBlogsは記事のリライトを行う関数
runDailyNowはscheduledBlogDaily_Morning 相当を即時実行（テスト / 手動用）
runA8DailyNowはscheduledBlogA8_Morning 相当を即時実行
runKarirakuGuideNowはscheduledKarirakuGuideDaily 相当を即時実行
a8_generateBlogFromOfferは特定の offerId を指定して商品紹介ブログを1本生成（管理用）
runUpdateBlogSeoNowは既存ブログのSEO分析・更新を1回だけ走らせるテスト用
🔍 GSC 連携まわり
スケジュール系
scheduledPullGscはGSC から検索クエリなどを定期取得

generateFromGSC

GSC から取ったデータを元にブログ（主にガイド系）を自動生成

HTTP 手動トリガー

runPullGscNow

scheduledPullGsc 相当を手動実行

runGenerateFromGscNow

generateFromGSC 相当を手動実行

🏢 A8オファー・サイト設定まわり

a8_normalizeOffers（HTTP）

A8オファーの整形・正規化（JSON → Firestore 変換など）

a8_updateOfferPrice（HTTP）

A8オファーの価格更新

a8_syncFromFiles（HTTP）

firebase/functions/ingest/a8/*.json から Firestore に同期

sites_syncFromFiles（HTTP）

sites/*.json から siteConfigs などに同期

📈 トラッキング・ヘルスチェック

trackClick（HTTP）

一般的なクリック計測

trackPainClick（HTTP）

「どの悩みが押されたか」のトラッキング

health（HTTP）

「生きてる？」確認用のシンプルなヘルスチェック

ーーーーーーーーーーーーーーーーーーーーーーーーーーー


